# Классификация объявлений с Авито с помощью NLP и CV моделей

В данной работе я спарсил данные объявлений с Авито, а именно: изображение (первое фото в объявлении), уникальный id, текст объявления и цену. Общее количество полученных объявлений >27 тысяч, из них >22 тысяч с изображениями, всего 17 категорий-классов объявлений. \
Классы объявлений несбалансированы, поэтому я построил два кастомных датасета (для изображений и для изображений и текста) и взвешенный семплер.\
На полученных объявлениях с изображениями я построил базовую модель для классификации изображений с помощью PyTorch, а затем  применил предобученные модели из pytorch-vision (Resnet50, EfficientNet). Также я попробовал сравнить качество модели с использованием аугментации и без. Итоговое значение лучшей модели на объявлениях с изображениями из валидационной выборки находится ниже в таблице. \
Затем я применил fine-tuned модель RuBERT и rubert-tiny2 к текстам объявлений. Текста объявлений были предварительно очищены от лишних символов и стоп-слов и токенизированы с помощью соответствующих токенайзеров. Результат лучшей модели на основе текстовых данных объявлений из валидационной выборки также находится ниже в таблице. \
Для увеличения качества результата я решил объединить модели с помощью использованных извлеченных признаков моделей, для этого я построил кастомный датасет и нейронную сеть использующую фичи моделей. Т.к. качество этой модели оказалось достаточно низким я решил объединить фичи моделей с помощью моделей классического обучения (логистическая регрессия, KNN, случайный лес) и добился качества >0.99 F1 \
Качество моделей: 
| Модель | F1-macro | Accuracy |
| --- | --- | --- |
| EfficientNet (на изображениях) | 0.915080	| 0.941207 |
| resnet50X	(на изображениях) | 0.892389	| 0.921956 |
| EfficientNet + albumentation (на изображениях) | 0.8716	| 0.9069 |
| rubert-tiny2 | 0.872 | 0.9416 |
| EffNet + rubert-tiny2 | 0.421072 | 0.606042 |
| RandomForest + EffNet + rubert-tiny2 | 0.375960	| 0.651032 | 
| KNN (15 neigh) + EffNet + rubert-tiny2 | 0.954844 |	0.967167 |	
| LogReg + EffNet + rubert-tiny2 | 0.991412 | 0.993619 | 

Использованные библиотеки: `PyTorch` для написания моделей и оформления датасетов, `Py-Lightning` для обучения моделей, `albumentation` для добавления аугментации, `HuggingFace` `Transformers` для построения NLP моделей и обучения, `sklearn` для моделей классического обучения в объединеннии признаков моделей, `wandb` для логгирования обучения и состояний моделей, `ntlk` для препроцессинга текста и т.д.
